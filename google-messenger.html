<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Agent - Conversational Messenger</title>

  <!-- DF Messenger CSS -->
  <link rel="stylesheet" href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">

  <!-- DF Messenger JS -->
  <script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script>
</head>

<body>

  <!-- DF Messenger Widget -->
  <df-messenger
      location="europe-west1"
      project-id="cf-gcpai-dev-mi"
      agent-id="9755be34-4b8f-4fce-8ae2-cba61fdb0a53"
      environment="6d86fecb-c379-424f-8520-e843942910b7"
      language-code="en"
      max-query-length="-1">

      <df-messenger-chat-bubble chat-title="test_agent"></df-messenger-chat-bubble>
  </df-messenger>

  <!-- Custom Styling -->
  <style>
    df-messenger {
      z-index: 999;
      position: fixed;
      --df-messenger-font-color: #000;
      --df-messenger-font-family: Google Sans;
      --df-messenger-chat-background: #f3f6fc;
      --df-messenger-message-user-background: #d3e3fd;
      --df-messenger-message-bot-background: #fff;
      bottom: 16px;
      right: 16px;
    }
  </style>

  <!-- Optional: Reset Chat Button -->
  <button id="reset-chat" 
          style="position: fixed; bottom: 80px; right: 16px; z-index:1000;">
    Reset Chat
  </button>

  <script>
    const messenger = document.querySelector('df-messenger');

    // Reset chat functionality
    document.getElementById('reset-chat').addEventListener('click', () => {
      messenger.reset();
    });

    // Optional: Pre-fill guidance for certain queries
    messenger.addEventListener('df-response-received', (event) => {
      const msg = event.detail.response.queryResult.text || "";
      if (msg.toLowerCase().includes("platform lead") || msg.toLowerCase().includes("presentation")) {
        messenger.renderCustomMessage("Hi! I see you're asking about the Platform Lead (PL) or a presentation. Please provide more context so I can assist you better.");
      }
    });
  </script>

</body>
</html>
